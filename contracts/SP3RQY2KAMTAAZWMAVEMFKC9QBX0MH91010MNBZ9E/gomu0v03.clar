(define-constant ERR_NOT_OWNER (err u6001)) (define-constant ERR_SWAP_FAILED (err u7001)) (define-constant ERR_REDEEM_FAILED (err u7002)) (define-constant owner tx-sender) (define-public (C-A-st (dx uint) (min uint) (owner-address principal) (prev-owner (optional principal))) (begin (asserts! (is-eq tx-sender owner) ERR_NOT_OWNER) (asserts! (> dx u0) (err u6002)) (let ((b1 (try! (swap-usdc-usda-bitflow-v4 dx))) (b2 (try! (redeem owner-address b1 prev-owner))) (received (get collateral-received b2))) (asserts! (>= received min) (err received)) (ok received)))) (define-private (swap-usdc-usda-bitflow-v4 (dx uint)) (ok (unwrap! (contract-call? 'SPQC38PW542EQJ5M11CR25P7BS1CA6QT4TBXGB3M.stableswap-usda-aeusdc-v-1-4 swap-y-for-x 'SP3Y2ZSH8P7D50B0VBTSX11S7XSG24M1VB9YFQA4K.token-aeusdc 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR.usda-token 'SPQC38PW542EQJ5M11CR25P7BS1CA6QT4TBXGB3M.usda-aeusdc-lp-token-v-1-4 dx u0) ERR_SWAP_FAILED))) (define-private (redeem (owner-address principal) (amount uint) (prev-owner (optional principal))) (ok (unwrap! (contract-call? 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR.arkadiko-vaults-manager-v1-2 redeem-vault 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR.arkadiko-vaults-tokens-v1-1 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR.arkadiko-vaults-data-v1-1 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR.arkadiko-vaults-sorted-v1-1 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR.arkadiko-vaults-pool-active-v1-1 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR.arkadiko-vaults-helpers-v1-1 'SP2C2YFP12AJZB4MABJBAJ55XECVS7E4PMMZ89YZR.arkadiko-oracle-v2-3 owner-address 'SP4SZE494VC2YC5JYG7AYFQ44F5Q4PYV7DVMDPBG.ststx-token amount prev-owner) ERR_REDEEM_FAILED)))
