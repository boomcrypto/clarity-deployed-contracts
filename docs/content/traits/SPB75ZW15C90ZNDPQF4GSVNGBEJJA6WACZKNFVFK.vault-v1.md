---
title: "Trait vault-v1"
draft: true
---
```
(use-trait ft-trait 'SP3DX3H4FEYZJZ586MFBS25ZW3HZDMEW92260R2PR.ft-trait.ft-trait) (use-trait extension-trait 'SP102V8P0F7JX67ARQ77WEA3D3CFB5XW39REDT0AM.extension-trait.extension-trait) (define-constant DEPLOYER tx-sender) (define-map approved-contracts principal bool) (define-data-var enabled bool true) (define-data-var owner principal tx-sender) (define-private (check-is-approved) (ok (asserts! (default-to false (map-get? approved-contracts tx-sender)) (err u9)))) (define-private (check-is-owner) (ok (asserts! (or (is-eq tx-sender (var-get owner)) (is-eq DEPLOYER (var-get owner))) (err u9)))) (define-public (set-owner (new-owner principal)) (begin (try! (check-is-owner)) (ok (var-set owner new-owner)))) (define-public (set-enabled (is-enabled bool)) (begin (try! (check-is-owner)) (ok (var-set enabled is-enabled)))) (define-public (add-approved-contract (new-approved-contract principal)) (begin (try! (check-is-owner)) (ok (map-set approved-contracts new-approved-contract true)))) (define-public (remove-approved-contract (approved-contract principal)) (begin (try! (check-is-owner)) (ok (map-delete approved-contracts approved-contract)))) (define-public (transfer-ft (token <ft-trait>) (amount uint) (recipient principal)) (begin (asserts! (is-ok (check-is-owner)) (err u9)) (as-contract (contract-call? token transfer amount tx-sender recipient none)))) (define-public (flash-loan-stx (flash-loan-user-trait <extension-trait>) (amount uint) (target principal) (data (buff 2048))) (let ((recipient tx-sender)) (asserts! (is-ok (check-is-approved)) (err u9)) (as-contract (try! (stx-transfer? amount tx-sender recipient))) (try! (contract-call? flash-loan-user-trait callback target data)) (try! (stx-transfer? amount recipient (as-contract tx-sender))) (ok true))) (define-public (flash-loan (flash-loan-user-trait <extension-trait>) (token-trait <ft-trait>) (amount uint) (target principal) (data (buff 2048))) (let ((recipient tx-sender)) (asserts! (is-ok (check-is-approved)) (err u9)) (as-contract (try! (contract-call? token-trait transfer amount tx-sender recipient none))) (try! (contract-call? flash-loan-user-trait callback target data)) (try! (contract-call? token-trait transfer amount recipient (as-contract tx-sender) none)) (ok true))) (define-public (use-extension (ext <extension-trait>)) (begin (asserts! (var-get enabled) (err u8)) (as-contract (contract-call? ext callback tx-sender 0x00))))
```
